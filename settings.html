<div id="swarm_settings" class="extension_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>SwarmUI Extension Settings</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <label for="swarm_url">SwarmUI Base URL (e.g., http://localhost:7801):</label>
            <input id="swarm_url" class="text_pole" type="text" value="http://localhost:7801" />

            <label for="swarm_session_id">Session ID (optional, leave blank to auto-generate):</label>
            <input id="swarm_session_id" class="text_pole" type="text" placeholder="Auto-generate if blank" />

            <label for="swarm_llm_prompt">Custom LLM Prompt Template:</label>
            <textarea id="swarm_llm_prompt" class="textarea_compact" rows="6">Generate a detailed, descriptive prompt for an image generation AI based on this scene: {description}</textarea>

            <div style="margin-top: 10px; padding: 10px; background-color: #f5f5f5; border-radius: 5px; font-size: 12px;">
                <strong>Enhanced Template Format:</strong><br>
                • Use message placeholders to insert specific messages:<br>
                &nbsp;&nbsp;- <code>{all_messages}</code> or <code>{description}</code> - All messages<br>
                &nbsp;&nbsp;- <code>{previous_messages}</code> - All messages except the latest<br>
                &nbsp;&nbsp;- <code>{message_0}</code> - Latest message only<br>
                &nbsp;&nbsp;- <code>{message_1}</code> - Second latest message<br>
                &nbsp;&nbsp;- <code>{message_2}</code> - Third latest message, etc.<br><br>

                • Use message type tags:<br>
                &nbsp;&nbsp;- <code>[system]...[/system]</code> for system messages<br>
                &nbsp;&nbsp;- <code>[user]...[/user]</code> for user messages<br>
                &nbsp;&nbsp;- <code>[assistant]...[/assistant]</code> for assistant messages<br>
                • Multiple messages of each type are supported<br><br>

                <strong>Example:</strong><br>
                <code>
                    [system]Create danbooru tags for the current scene.[/system]<br>
                    [user]Latest message: {message_0}[/user]<br>
                    [user]Previous context: {previous_messages}[/user]<br>
                    [user]Focus on current actions, max 20 tags.[/user]
                </code><br><br>

                <strong>Legacy format still works:</strong> Text before {description} = system, after = user suffix
            </div>

            <label for="swarm_append_prompt"><input id="swarm_append_prompt" type="checkbox" checked /> Append generated prompt to current SwarmUI prompt (instead of replacing)</label>
            <label for="swarm_use_raw"><input id="swarm_use_raw" type="checkbox" /> Use generateRaw (bypasses system instructions and character card)</label>
            <label for="swarm_message_count">Number of messages to include (when using generateRaw):</label>
            <input id="swarm_message_count" class="text_pole" type="number" min="1" max="50" value="5" />
            <label for="swarm_test_mode"><input id="swarm_test_mode" type="checkbox" /> Test mode: Only generate and display prompt (don't create image)</label>
        </div>
    </div>
</div>